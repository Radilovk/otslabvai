# Ръководство за Промо Код Система

## Обща Информация

Системата за промо кодове позволява на администраторите да създават, управляват и следят използването на промо кодове, които клиентите могат да използват за отстъпки при поръчка.

## За Администратори

### Достъп до Администраторския Панел

1. Отворете админ панела: `https://your-domain.com/admin.html`
2. Изберете таба **"Промо Кодове"**

### Създаване на Нов Промо Код

1. Натиснете бутона **"+ Нов Промо Код"**
2. Попълнете формата:
   - **Код*** (задължително): Уникален код (напр. SAVE10, WELCOME5)
   - **Отстъпка*** (задължително): Размер на отстъпката (1-100 за процент, или фиксирана сума)
   - **Тип отстъпка**: Процент (%) или Фиксирана сума (€)
   - **Описание**: Кратко описание на промоцията
   - **Валиден от**: Дата и час на активиране
   - **Валиден до**: Дата и час на изтичане (празно = безсрочен)
   - **Максимален брой използвания**: Лимит на използванията (празно = неограничено)
   - **Активен**: Чекбокс за активиране/деактивиране
3. Натиснете **"Запази"**

### Редактиране на Промо Код

1. Намерете кода в таблицата
2. Натиснете бутона **"Редактирай"**
3. Променете желаните полета
4. Натиснете **"Запази"**

**Забележка**: Кодът не може да бъде променен след създаване. Ако искате различен код, създайте нов промо код.

### Деактивиране на Промо Код

- Използвайте превключвателя (toggle switch) в колоната **"Активен"**
- Деактивираните кодове не могат да се използват от клиенти
- Те остават в системата и могат да бъдат активирани отново

### Изтриване на Промо Код

1. Натиснете бутона **"Изтрий"** до съответния код
2. Потвърдете изтриването

**Внимание**: Изтрити промо кодове не могат да бъдат възстановени!

### Търсене и Филтриране

- Използвайте полето за търсене, за да намерите код по име или описание
- Резултатите се актуализират автоматично при писане

### Преглед на Статистика

В таблицата виждате:
- **Използвания**: Показва колко пъти е използван кодът и максималния лимит
- **Валидност**: Период, в който кодът е валиден
- **Статус**: Дали кодът е активен или не

### Опресняване на Данните

- Натиснете **"Опресни"** за да зредите най-новите данни от сървъра

## За Клиенти

### Как да Използвате Промо Код

1. Добавете продукти в количката
2. Отидете на страницата за поръчка (checkout)
3. Намерете секцията **"Промо код"**
4. Въведете вашия промо код в полето
5. Натиснете бутона **"Приложи"**

### Какво Се Случва След Прилагане

- Системата проверява дали кодът е валиден
- Ако е валиден, отстъпката се прилага автоматично
- Виждате новата цена в секцията "Обобщение на поръчката"
- След успешна поръчка, използването на кода се увеличава автоматично

### Типични Грешки

**"Невалиден промо код"**
- Кодът е въведен грешно
- Кодът не съществува в системата

**"Промо кодът не е активен"**
- Кодът е деактивиран от администратор

**"Промо кодът все още не е валиден"**
- Кодът има начална дата в бъдещето

**"Промо кодът е изтекъл"**
- Валидността на кода е изтекла

**"Промо кодът е изчерпан"**
- Достигнат е максималният брой използвания

## Технически Детайли

### Видове Отстъпки

1. **Процентна отстъпка**: Намалява цената с определен процент
   - Пример: 10% отстъпка от 100€ = 10€ отстъпка
   
2. **Фиксирана отстъпка**: Намалява цената с определена сума
   - Пример: 5€ отстъпка от поръчка
   - Отстъпката никога не надхвърля стойността на поръчката

### Валидация

Системата автоматично проверява:
- ✓ Активен статус
- ✓ Дати на валидност
- ✓ Лимит на използвания
- ✓ Формат на кода (автоматично преобразуване в главни букви)

### Съхранение

Промо кодовете се съхраняват в Cloudflare KV storage за бърз достъп и висока надеждност.

### API Endpoints

За разработчици:
- `GET /promo-codes` - Списък с всички кодове
- `POST /promo-codes` - Създаване на нов код
- `PUT /promo-codes` - Актуализация на код
- `DELETE /promo-codes` - Изтриване на код
- `POST /validate-promo` - Валидация на код при поръчка

## Често Задавани Въпроси

**В: Може ли клиент да използва повече от един промо код?**
О: Не, системата позволява само един промо код на поръчка.

**В: Какво се случва с използваните кодове в стари поръчки?**
О: Информацията за използвания промо код се запазва в данните на поръчката.

**В: Може ли да се създаде код с изтекла валидност?**
О: Да, но той няма да може да се използва от клиенти.

**В: Как да създам код за конкретен клиент?**
О: Създайте код с maxUses = 1 и го споделете само с този клиент.

**В: Прилага ли се отстъпката върху доставката?**
О: Не, отстъпката се прилага само върху стойността на продуктите (subtotal).

## Поддръжка

За технически проблеми или въпроси, свържете се с развойния екип.
